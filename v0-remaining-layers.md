# v0 阶段剩余 Issue 分层分析

> **注意**: UE 相关 Issue 暂不开发，优先完成 Backend/Web/Data/Infra 部分。
> UE 与 Web 完全独立，跳过 UE 不影响其他功能的开发进度。
> 非 UE Issue 总计：**52 个**（原 82 个减去 UE 30 个）

## 已完成 Issue (Closed)
```
EP-01: ST-0001~0005 ✅
EP-02: ST-0006~0010 ✅
EP-06: ST-0026~0029 ✅
EP-07: ST-0030~0034 ✅
EP-08: ST-0036~0040, ST-0096 ✅
EP-09: ST-0041~0044, ST-0046~0047 ✅
EP-10: ST-0048 ✅
EP-12: ST-0052~0056 ✅
EP-14: ST-0061~0062 ✅
EP-16: ST-0070~0072 ✅
EP-17: ST-0074~0075 ✅
EP-18: ST-0080~0082 ✅
EP-30: ST-0145~0146 ✅
EP-31: ST-0150, ST-0153 ✅
其他: ST-0116, ST-0155~0156 ✅
```

---

## Layer 0 (无依赖或依赖已完成 - 可立即开始)

### Backend (7)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 80 | ST-0049 | 风矢数据缓存与热点预热 | ST-0048 ✅ |
| 94 | ST-0063 | Products API：列表查询 | ST-0062 ✅ |
| 104 | ST-0073 | 风险点聚类/抽稀 | ST-0071 ✅ |
| 107 | ST-0076 | 风险解释 reasons 输出格式 | ST-0075 ✅ |
| 108 | ST-0077 | Risk API：/risk/evaluate 缓存 | ST-0075 ✅ |
| 110 | ST-0079 | 风险评估性能优化 | ST-0075 ✅ |
| 193 | ST-0162 | 色标/阈值配置中心 | ST-0046 ✅ |

### Web (7)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 42 | ST-0011 | Web CesiumJS Viewer | ST-0002 ✅ |
| 47 | ST-0016 | Attribution 展示组件 | ST-0005 ✅ |
| 117 | ST-0086 | TimeController 时间轴 | ST-0037,0042 ✅ |
| 119 | ST-0088 | Legend 服务 | ST-0046 ✅ |
| 120 | ST-0089 | 错误边界与降级提示 | ST-0005,0008 ✅ |
| 139 | ST-0108 | Web 灾害演示（简化特效）| ST-0080,0081 ✅ |
| 146 | ST-0115 | 诊断面板 | ST-0005 ✅ |

### UE (2)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 48 | ST-0017 | UE 项目初始化 Cesium | ST-0001 ✅ |
| 152 | ST-0121 | UE DataClient HTTP | ST-0005 ✅ |

### Data (2)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 66 | ST-0035 | 云密度派生接口 | ST-0030 ✅ |
| 76 | ST-0045 | 风速瓦片生成 | ST-0034 ✅ |

### Infra/Test (2)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 180 | ST-0149 | 性能压测 | ST-0007 ✅ |
| 185 | ST-0154 | 用户帮助文档 | None |

---

## Layer 1 (依赖 Layer 0)

### Backend (2)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 95 | ST-0064 | Products API：详情查询 | ST-0063 (L0) |
| 109 | ST-0078 | Risk pois 返回 risk_level | ST-0077 (L0) |

### Web (5)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 43 | ST-0012 | Cesium World Terrain | ST-0011 (L0) |
| 115 | ST-0084 | Web 应用框架布局 | ST-0011 (L0) |
| 116 | ST-0085 | Mode 状态机 | ST-0084 (L1) |
| 118 | ST-0087 | LayerManager | ST-0084 (L1) |
| 144 | ST-0113 | 瓦片预取与缓存 | ST-0088 (L0) |

### UE (5)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 49 | ST-0018 | UE 地形与影像 | ST-0017 (L0) |
| 52 | ST-0021 | UE 归因展示 | ST-0017 (L0) |
| 148 | ST-0117 | UE 时间轴播放 | ST-0017 (L0) |
| 150 | ST-0119 | UE 点选拾取 | ST-0017 (L0) |
| 156 | ST-0125 | UE 风矢可视化 | ST-0049 (L0) |

---

## Layer 2 (依赖 Layer 1)

### Backend (1)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 96 | ST-0065 | 产品缓存与 ETag | ST-0064 (L1) |

### Web (12)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 44 | ST-0013 | 全球影像底图 | ST-0012 (L1) |
| 45 | ST-0014 | OSM 3D Buildings | ST-0012 (L1) |
| 121 | ST-0090 | 温度图层渲染 | ST-0087 (L1) |
| 122 | ST-0091 | 云图层渲染 | ST-0087 (L1) |
| 123 | ST-0092 | 降水热力图层 | ST-0087 (L1) |
| 124 | ST-0093 | 降水粒子系统 | ST-0089 (L0) |
| 125 | ST-0094 | 风矢渲染 | ST-0087 (L1), ST-0049 (L0) |
| 131 | ST-0100 | 壳层渲染实现 | ST-0087 (L1) |
| 132 | ST-0101 | 状态保持 | ST-0086 (L0) |
| 135 | ST-0104 | 自动图层策略 | ST-0087 (L1) |
| 136 | ST-0105 | 监测图层叠加 | ST-0087 (L1) |
| 143 | ST-0112 | 请求合并节流 | ST-0086 (L0) |

### UE (6)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 50 | ST-0019 | UE OSM Buildings | ST-0018 (L1) |
| 149 | ST-0118 | UE 层选择开关 | ST-0090 (L2) |
| 151 | ST-0120 | UE 模式管理 | ST-0113 (L1) |
| 153 | ST-0122 | UE 温度图层 | ST-0117 (L1) |
| 154 | ST-0123 | UE 云 P0 | ST-0117 (L1) |
| 155 | ST-0124 | UE 降水粒子 | ST-0117 (L1) |

---

## Layer 3 (依赖 Layer 2)

### Web (10)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 126 | ST-0095 | 点取样数值卡片 | ST-0091 (L2) |
| 128 | ST-0097 | 点击进入 Local | ST-0086 (L0), ST-0091 (L2) |
| 129 | ST-0098 | Local 仰视视角 | ST-0092 (L2) |
| 130 | ST-0099 | 锁层 LayerGlobal | ST-0093 (L2) |
| 133 | ST-0102 | 事件列表面板 | ST-0063 (L0), ST-0085 (L1) |
| 137 | ST-0106 | 风险点加载渲染 | ST-0079 (L0) |
| 138 | ST-0107 | 风险点详情弹窗 | ST-0076 (L0), ST-0079 (L0) |
| 145 | ST-0114 | 性能模式开关 | ST-0107 (L3) |
| 178 | ST-0147 | Web E2E 测试 | ST-0085 (L1) |
| 182 | ST-0151 | Web 归因弹窗 | ST-0150 ✅ |

### UE (7)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 157 | ST-0126 | UE HUD | ST-0091 (L2) |
| 159 | ST-0128 | 轨迹生成 | ST-0117 (L1) |
| 160 | ST-0129 | 飞行控制 | ST-0118 (L2) |
| 161 | ST-0130 | 穿层联动 | ST-0119 (L1) |
| 165 | ST-0134 | 特效性能保护 | ST-0122 (L2) |
| 166 | ST-0135 | v1 第二特效 | ST-0122 (L2) |
| 173 | ST-0142 | UE 事件列表 | ST-0063 (L0), ST-0114 (L3) |

---

## Layer 4 (依赖 Layer 3)

### Web (4)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 134 | ST-0103 | 事件区域渲染 | ST-0097 (L3) |
| 190 | ST-0159 | 飞行器示例渲染 | ST-0092 (L2) |
| 189 | ST-0158 | 2D/3D 模式切换 | ST-0085 (L1) |
| 188 | ST-0157 | 瓦片质量校验 | ST-0138 (不存在) |

### UE (6)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 158 | ST-0127 | 飞行航线编辑 | ST-0112 (L2) |
| 162 | ST-0131 | 飞行视角选项 | ST-0120 (L2) |
| 163 | ST-0132 | UE 灾害特效 滑坡 | ST-0082 ✅, ST-0114 (L3) |
| 164 | ST-0133 | 特效与风险点绑定 | ST-0079 (L0), ST-0082 ✅ |
| 174 | ST-0143 | UE 事件区域渲染 | ST-0097 (L3) |
| 175 | ST-0144 | UE 风险点交互 | ST-0079 (L0) |
| 179 | ST-0148 | UE 回归脚本 | ST-0114 (L3) |
| 183 | ST-0152 | UE 归因面板 | ST-0150 ✅ |

---

## Layer 5 (依赖 Layer 4)

### UE (2)
| # | Issue | Title | Dependencies |
|---|-------|-------|--------------|
| 191 | ST-0160 | UE Local->LayerGlobal | ST-0112 (L2) |
| 192 | ST-0161 | UE 事件模式模板 | ST-0097 (L3) |

---

## 统计摘要

| Layer | Backend | Web | UE | Data | Infra | Total |
|-------|---------|-----|----|----- |-------|-------|
| 0 | 7 | 7 | ~~2~~ | 2 | 2 | **20** → **18** |
| 1 | 2 | 5 | ~~5~~ | 0 | 0 | **12** → **7** |
| 2 | 1 | 12 | ~~6~~ | 0 | 0 | **19** → **13** |
| 3 | 0 | 10 | ~~7~~ | 0 | 0 | **17** → **10** |
| 4 | 0 | 4 | ~~8~~ | 0 | 0 | **12** → **4** |
| 5 | 0 | 0 | ~~2~~ | 0 | 0 | **2** → **0** |
| **Total** | **10** | **38** | ~~30~~ | **2** | **2** | **82** → **52** |

> **实际开发**: 排除 UE 后，共 **52 个 Issue** 需要完成

---

## 建议执行顺序（排除 UE）

### Phase 1: 后端完善 + Web 基础框架 (Layer 0-1)
优先完成 Backend 所有 Layer 0-1 issue，同时启动 Web 基础框架。

**批次 1.1** (Backend L0): #80, #94, #104, #107, #108, #110, #193
**批次 1.2** (Web L0): #42, #47, #117, #119, #120, #139, #146
**批次 1.3** (Data L0): #66, #76
**批次 1.4** (Infra L0): #180, #185
**批次 1.5** (Backend L1 + Web L1): #95, #109, #43, #115, #116, #118, #144

### Phase 2: Web 可视化 (Layer 2)
**批次 2.1** (Backend L2): #96
**批次 2.2** (Web L2): #44, #45, #121~125, #131, #132, #135, #136, #143

### Phase 3: Web 场景交互 (Layer 3-4)
**批次 3.1** (Web L3): #126, #128~130, #133, #137, #138, #145, #178, #182
**批次 3.2** (Web L4): #134, #188, #189, #190

---

## ~~原建议执行顺序（含 UE）~~

> 以下为原始计划，包含 UE 开发，暂不执行

### ~~Phase 1: 后端完善 + Web/UE 基础框架 (Layer 0-1)~~
~~优先完成 Backend 所有 Layer 0-1 issue，同时启动 Web/UE 基础框架。~~

~~**批次 1.1** (Backend L0): #80, #94, #104, #107, #108, #110, #193~~
~~**批次 1.2** (Web L0): #42, #47, #117, #119, #120, #139, #146~~
~~**批次 1.3** (UE L0): #48, #152~~
~~**批次 1.4** (Backend L1 + Web/UE L1): #95, #109, #43, #115, #49, #52, #148, #150, #156~~

### ~~Phase 2: Web 可视化 + UE 渲染 (Layer 2)~~
~~**批次 2.1** (Web L2): #44, #45, #121~125, #131, #132, #135, #136, #143~~
~~**批次 2.2** (UE L2): #50, #149, #151, #153~155~~

### ~~Phase 3: 场景交互 (Layer 3-4)~~
~~**批次 3.1** (Web L3): #126, #128~130, #133, #137, #138, #145, #178, #182~~
~~**批次 3.2** (UE L3-4): #157~165, #173~175, #179, #183~~

### ~~Phase 4: 高级功能 + 测试 (Layer 5)~~
~~**批次 4.1**: #191, #192, #180, #185, #188~~

---

*生成时间: 2026-01-19*
